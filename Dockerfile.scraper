FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1

WORKDIR /app

COPY requirements.txt ./
RUN pip install --no-cache-dir -r requirements.txt

COPY scraper ./scraper

ENV ELASTICSEARCH_URL=${ELASTICSEARCH_URL:-http://es:9200} \
    ES_INDEX=${ES_INDEX:-products}

CMD ["python", "-m", "scraper.scrape_and_index"]

